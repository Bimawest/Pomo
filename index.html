<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daftar Pendaftar dan Kalkulator Patungan</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Trade+Winds&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 100%;
            margin: auto;
            background-image: url('img/pomo.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            justify-items: center;
        }
        
        .pomo {
          width: 95%;
          height: 100%;
          background-color: rgba(225, 225, 225, 0.1);
          backdrop-filter: blur(1.5px);
          color: white;
          outline: 3px black dashed;
          border-radius: 25px;
          padding: 3px;
          margin-top: 5%;
        }
        
        h1 {
          font-family: "Trade Winds";
          font-style: italic;
        }

        h1, h2 {
            color: white;
            margin: 5px;
            text-shadow: 
    -1px -1px 0 #000,  
    1px -1px 0 #000,
    -1px 1px 0 #000,
    1px 1px 0 #000;
        }
        form {
            margin-bottom: 20px;
            margin: 5px;
        }
        
        #tabel-container {
    max-height: 250px; /* Adjust this value as needed */
    width: 90%;
    overflow-y: scroll;
    border: 1px solid #ddd; /* Optional: adds a border to the container */
    margin-top: 20px;
    margin: 5px;
}

hr {
  width: 80%;
  margin: 5px;
}

/* Lebar scrollbar */
::-webkit-scrollbar {
  width: 10px;
}

/* Warna latar belakang scrollbar */
::-webkit-scrollbar-track {
  background: #f1f1f1;
}

/* Warna "jempol" scrollbar (bagian yang dapat digeser) */
::-webkit-scrollbar-thumb {
  background: #888;
}


#daftar-pendaftar {
    width: 100%;
    border-collapse: collapse;
}

#daftar-pendaftar th,
#daftar-pendaftar td {
    color: #000;
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
    text-shadow: 
    -1px -1px 0 #fff,  
    1px -1px 0 #fff,
    -1px 1px 0 #fff,
    1px 1px 0 #fff;
}

#daftar-pendaftar td {
  font-family: cursive;
  font-size: 1.1rem;
}

#daftar-pendaftar th {
    background-color: #333;
    position: sticky;
    top: 0;
    z-index: 1; /* Ensures the header stays on top of the scrolling content */
}

        .highlight, .duit {
            font-weight: bold;
            color: #007BFF;
        }
        
        p {
          font-size: 1.1rem;
          color: #000;
          margin: 5px;
          text-shadow: 
    -1px -1px 0 #fff,  
    1px -1px 0 #fff,
    -1px 1px 0 #fff,
    1px 1px 0 #fff;
        }
    </style>
</head>
<body>
  
<section class="pomo">
    <h1>PB. POMO Kuala</h1>

    <form id="form-pendaftaran">
        <input type="text" id="nama-pendaftar" placeholder="Masukkan nama Anda" required>
        <button type="submit">Daftar</button>
    </form>

    <p id="pesan-status"></p>

    <div id="tabel-container">
    <table id="daftar-pendaftar">
        <thead>
            <tr>
                <th>No</th>
                <th>Nama Pemain</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>


    <hr>

    <h2>Kalkulator Patungan</h2>
    <p>lapangan: <span class="duit">Rp 100.000</span></p>
    <p>shuttlecock: <span class="duit">Rp 134.000</span></p>
    <p>Total harga: <span class="highlight">Rp 234.000</span></p>
    <p>Jumlah pemain: <span id="jumlah-pendaftar" class="highlight">0</span> orang</p>
    <p>Patungan per orang: <span id="patungan-per-orang" class="highlight">Rp 0</span></p>
</section>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const URL_APPS_SCRIPT_ANDA = 'https://script.google.com/macros/s/AKfycbzJOkRvOLJqBXzkOFZzFcZSvoIXiPF4KtJ2QgvKV3KJnM--7gZOHyZKaxFiFpgYdS7iFw/exec'; // Ganti dengan URL Anda

            const totalHarga = 234000;
            const tableBody = document.querySelector('#daftar-pendaftar tbody');
            const jumlahPendaftarSpan = document.getElementById('jumlah-pendaftar');
            const patunganPerOrangSpan = document.getElementById('patungan-per-orang');
            const formPendaftaran = document.getElementById('form-pendaftaran');
            const pesanStatus = document.getElementById('pesan-status');

            function muatDaftarPendaftar() {
                // Hapus data lama di tabel
                tableBody.innerHTML = '<tr><td colspan="2">Loading data dari Google Sheets...</td></tr>';
                
                fetch(URL_APPS_SCRIPT_ANDA)
                    .then(response => response.json())
                    .then(data => {
                        tableBody.innerHTML = ''; // Kosongkan tabel
                        if (data && data.length > 0) {
                            data.forEach((pendaftar, index) => {
                                const row = tableBody.insertRow();
                                const noCell = row.insertCell(0);
                                const namaCell = row.insertCell(1);
                                noCell.textContent = index + 1;
                                namaCell.textContent = pendaftar['Nama']; // Ganti 'Nama' sesuai header kolom Anda
                            });
    
                            const jumlahPendaftar = data.length;
                            const patunganPerOrang = totalHarga / jumlahPendaftar;
    
                            jumlahPendaftarSpan.textContent = jumlahPendaftar;
                            patunganPerOrangSpan.textContent = `Rp ${patunganPerOrang.toLocaleString('id-ID')}`;
                        } else {
                            tableBody.innerHTML = '<tr><td colspan="2">Tidak ada pendaftar.</td></tr>';
                            jumlahPendaftarSpan.textContent = 0;
                            patunganPerOrangSpan.textContent = `Rp 0`;
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching data:', error);
                        tableBody.innerHTML = '<tr><td colspan="2">Gagal memuat data. Periksa URL Apps Script Anda.</td></tr>';
                    });
            }

            // Panggil fungsi untuk memuat data saat halaman pertama kali dibuka
            muatDaftarPendaftar();
            
            // Tangani pengiriman formulir
            formPendaftaran.addEventListener('submit', function(event) {
                event.preventDefault();

                const namaPendaftar = document.getElementById('nama-pendaftar').value;
                pesanStatus.textContent = 'Menambahkan pendaftar...';

                // Kirim data ke Google Apps Script
                fetch(URL_APPS_SCRIPT_ANDA, {
                    method: 'POST',
                    body: JSON.stringify({ nama: namaPendaftar }),
                })
                .then(response => response.text())
                .then(result => {
                    pesanStatus.textContent = result;
                    document.getElementById('nama-pendaftar').value = '';
                    muatDaftarPendaftar(); // Muat ulang daftar setelah pendaftaran
                })
                .catch(error => {
                    console.error('Error submitting data:', error);
                    pesanStatus.textContent = 'Gagal menambahkan pendaftar.';
                });
            });
        });
    </script>

</body>
</html>
